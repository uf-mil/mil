<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="environment" default="real" /> <arg name="dvl" default="True" /> <arg name="imu" default="True" />
  <arg name="depth" default="True" />
<!-- DVL -->
  <group if="$(eval dvl and environment == 'real')">
    <node pkg="subjugator_launch" type="dvl_conn" name="dvl_conn" respawn="true" respawn_delay = "10"/>
    <node pkg="nodelet" type="nodelet" name="dvl_driver" args="standalone rdi_explorer_dvl/nodelet">
      <param name="port" type="string" value="/tmp/dvl"/>
      <param name="frame_id" type="string" value="/dvl"/>
    </node>

  </group>

  <!-- Depth Sensor -->
  <group if="$(eval depth and environment == 'real')">
    <node pkg="nav_tube_driver" type="nav_tube_driver_node" name="nav_tube_driver_node" respawn="true">
      <param name="ip" type="string" value="192.168.37.61" />
      <param name="port" type="int" value="33056" /> <param name="frame_id" type="string" value="/depth" />
      <param name="hz" type="int" value="20" />
    </node>
  </group>

  <!-- IMU -->
  <group if="$(arg imu)" >
      <group if="$(eval environment == 'real')">
          <include file="$(find vectornav)/launch/vn100_imu.launch">
          </include>
        </group>

</group>

    <node pkg="mil_tools" type="mag_to_marker.py" name="magnetometer_vis"
          args="/imu/mag /imu/marker -l3" />
        <node pkg="nodelet" type="nodelet" name="magnetic_hardsoft_compensation" args="standalone magnetic_hardsoft_compensation/nodelet">
          <param name="frame_id" type="string" value="imu"/>
          <rosparam>
                scale:
                - - 1.1062758626220242
                  - -0.028009777141301265
                  - -0.02149047334986777
                - - -0.02800977714130123
                  - 0.9586858114380179
                  - 0.004778755230769804
                - - -0.02149047334986775
                  - 0.004778755230769747
                  - 0.9440225372567164
                shift:
                - -0.21447364299513154
                - 0.3817478172486945
                - -0.9233526533964265
          </rosparam>
    </node>

</launch>
